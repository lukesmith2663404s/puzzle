<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Puzzle Sequence</title>
<style>
    body {
        background-color: black;
        color: white;
        font-family: Arial, sans-serif;
        text-align: center;
        margin: 0;
        padding: 0;
    }
    .hidden {
        display: none;
    }
    input.code-input {
        width: 40px;
        height: 40px;
        font-size: 24px;
        text-align: center;
        margin: 5px;
        background-color: #222;
        color: white;
        border: 1px solid #555;
    }
    button {
        background-color: #444;
        color: white;
        border: none;
        padding: 10px 20px;
        margin: 10px;
        cursor: pointer;
    }
    button:disabled {
        background-color: #222;
        cursor: not-allowed;
    }
    /* Puzzle 1 */
    .grid {
        display: grid;
        grid-template-columns: repeat(5, 60px);
        grid-template-rows: repeat(5, 60px);
        gap: 2px;
        justify-content: center;
        margin-top: 20px;
    }
    .cell {
        background-color: #333;
        font-size: 24px;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        color: white;
    }
    .outer-cell {
        background-color: black;
        cursor: default;
    }
    /* Puzzle 2 */
    .crossword {
        margin-top: 40px;
        display: inline-block;
        border-collapse: collapse;
    }
    .crossword td {
        width: 40px;
        height: 40px;
        border: 1px solid white;
        position: relative;
    }
    .crossword input {
        width: 100%;
        height: 100%;
        border: none;
        text-align: center;
        font-size: 20px;
        background-color: white;
        color: black;
    }
    .crossword .black {
        background-color: black;
    }
    .crossword .number {
        position: absolute;
        top: 2px;
        left: 2px;
        font-size: 10px;
        color: black;
    }
    /* Puzzle 3 */
    #clock {
        font-size: 48px;
        margin-top: 20px;
    }
    /* Puzzle 4 */
    .connect4-board {
        display: grid;
        grid-template-columns: repeat(7, 60px);
        grid-template-rows: repeat(6, 60px);
        gap: 2px;
        justify-content: center;
        margin: 20px auto;
        background-color: #000;
    }
    .connect4-cell {
        width: 60px;
        height: 60px;
        background-color: #333;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 0;
    }
    .red { background-color: red; }
    .yellow { background-color: yellow; }
</style>
</head>
<body>

<!-- Code Entry -->
<div id="code-entry">
    <h1>Enter Code</h1>
    <div>
        <input class="code-input" maxlength="1">
        <input class="code-input" maxlength="1">
        <input class="code-input" maxlength="1">
        <input class="code-input" maxlength="1">
        <input class="code-input" maxlength="1">
    </div>
</div>

<!-- Puzzle 1 -->
<div id="puzzle1" class="hidden">
    <h2>Puzzle 1</h2>
    <div class="grid" id="grid1"></div>
    <p id="result1"></p>
    <button id="reset1">Reset</button>
    <button id="next1" class="hidden" onclick="showSection('puzzle2')">Next</button>
</div>

<!-- Puzzle 2 -->
<div id="puzzle2" class="hidden">
    <h2>Puzzle 2</h2>
    <table class="crossword" id="crossword"></table>
    <button id="next2" class="hidden" onclick="showSection('puzzle3')">Next</button>
    <div id="clues">
<pre>
ACROSS
1A. 2F Lecturers
5A. With 8A, despite the fact...
6A. What e = 2?
8A. See 5A
10A. Donned on body parts...

DOWN
1D. Fastened bands...
2D. George and Ruthie's...
3D. The beginning of knowledge...
4D. What does a sender do?
7D. You might well say this...
9D. So you want to know 9D? ...
</pre>
    </div>
</div>

<!-- Puzzle 3 -->
<div id="puzzle3" class="hidden">
    <h2>Puzzle 3</h2>
    <div id="clock"></div>
    <button id="primeBtn3">Prime Time?</button>
    <p id="primeMsg3"></p>
    <button id="next3" class="hidden" onclick="showSection('puzzle4')">Next</button>
</div>

<!-- Puzzle 4 -->
<div id="puzzle4" class="hidden">
    <h2>Puzzle 4 - Connect 4</h2>
    <div class="connect4-board" id="connect4Board"></div>
    <button id="reset4">Reset</button>
    <p id="hahaMsg" style="height:20px;"></p>
    <button id="next4" class="hidden" onclick="showSection('puzzle5')">Next</button>
</div>

<!-- Puzzle 5 -->
<div id="puzzle5" class="hidden">
    <h2>Puzzle 5 coming soon</h2>
</div>

<script>
/* ===== Code Entry ===== */
const codeInputs = document.querySelectorAll('.code-input');
codeInputs.forEach((input, idx) => {
    input.addEventListener('input', () => {
        if (input.value.length === 1 && idx < codeInputs.length - 1) {
            codeInputs[idx + 1].focus();
        }
        checkCode();
    });
});
function checkCode() {
    const code = Array.from(codeInputs).map(i => i.value.toUpperCase()).join('');
    if (code === 'JONES') showSection('puzzle1');
}
function showSection(id) {
    document.querySelectorAll('body > div').forEach(div => div.classList.add('hidden'));
    document.getElementById(id).classList.remove('hidden');
}

/* ===== Puzzle 1 ===== */
// Puzzle 1 code remains unchanged (omitted for brevity, assume working from your current version)

/* ===== Puzzle 2 ===== */
// Puzzle 2 code remains unchanged (omitted for brevity, assume working from your current version)

/* ===== Puzzle 3 ===== */
const primesUnder60 = [2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59];
function updateClock() {
    const now = new Date();
    const hh = now.getHours().toString().padStart(2,'0');
    const mm = now.getMinutes().toString().padStart(2,'0');
    document.getElementById('clock').textContent = `${hh} : ${mm}`;
}
setInterval(updateClock, 1000);
updateClock();
document.getElementById('primeBtn3').addEventListener('click', () => {
    const [hh, mm] = document.getElementById('clock').textContent.split(' : ').map(n=>parseInt(n));
    let msgs = [];
    if (!primesUnder60.includes(hh)) msgs.push(`${hh} isn't prime`);
    if (!primesUnder60.includes(mm)) msgs.push(`${mm} isn't prime`);
    if (msgs.length === 0) {
        document.getElementById('next3').classList.remove('hidden');
    } else {
        document.getElementById('primeMsg3').textContent = msgs.join(' | ');
    }
});

/* ===== Puzzle 4 ===== */
const ROWS = 6, COLS = 7;
let board4, currentPlayer4, gameOver4, cpuFirstTurnDone;
function initConnect4() {
    board4 = Array.from({length: ROWS}, () => Array(COLS).fill(null));
    currentPlayer4 = 'CPU';
    gameOver4 = false;
    cpuFirstTurnDone = false;
    renderBoard4();
    if (currentPlayer4 === 'CPU') cpuMove4();
}
function renderBoard4() {
    const boardDiv = document.getElementById('connect4Board');
    boardDiv.innerHTML = '';
    for (let r=0; r<ROWS; r++) {
        for (let c=0; c<COLS; c++) {
            const cell = document.createElement('div');
            cell.className = 'connect4-cell';
            if (board4[r][c] === 'CPU') cell.classList.add('red');
            if (board4[r][c] === 'Player') cell.classList.add('yellow');
            cell.addEventListener('click', () => playerMove4(c));
            boardDiv.appendChild(cell);
        }
    }
}
function dropDisc4(col, player) {
    for (let r=ROWS-1; r>=0; r--) {
        if (!board4[r][col]) {
            board4[r][col] = player;
            return true;
        }
    }
    return false;
}
function cpuMove4() {
    if (gameOver4) return;
    // simple "smart" move placeholder (choose first available col)
    let moveCols = [...Array(COLS).keys()].filter(c => !board4[0][c]);
    if (moveCols.length === 0) return;
    let col = moveCols[Math.floor(Math.random()*moveCols.length)];
    dropDisc4(col, 'CPU');
    // unfair first turn chance
    if (!cpuFirstTurnDone && Math.random() < 1/3) {
        let col2 = moveCols.filter(c => c !== col);
        if (col2.length) {
            col2 = col2[Math.floor(Math.random()*col2.length)];
            dropDisc4(col2, 'CPU');
        }
        document.getElementById('hahaMsg').textContent = 'haha';
        setTimeout(()=>document.getElementById('hahaMsg').textContent='',1000);
    }
    cpuFirstTurnDone = true;
    renderBoard4();
    if (checkWin4('CPU')) { gameOver4 = true; return; }
    currentPlayer4 = 'Player';
}
function playerMove4(col) {
    if (gameOver4 || currentPlayer4 !== 'Player') return;
    if (!dropDisc4(col, 'Player')) return;
    renderBoard4();
    if (checkWin4('Player')) {
        gameOver4 = true;
        document.getElementById('next4').classList.remove('hidden');
        return;
    }
    currentPlayer4 = 'CPU';
    cpuMove4();
}
function checkWin4(player) {
    // check horizontal, vertical, diagonal
    for (let r=0;r<ROWS;r++) {
        for (let c=0;c<COLS;c++) {
            if (c+3<COLS && [0,1,2,3].every(i=>board4[r][c+i]===player)) return true;
            if (r+3<ROWS && [0,1,2,3].every(i=>board4[r+i][c]===player)) return true;
            if (c+3<COLS && r+3<ROWS && [0,1,2,3].every(i=>board4[r+i][c+i]===player)) return true;
            if (c-3>=0 && r+3<ROWS && [0,1,2,3].every(i=>board4[r+i][c-i]===player)) return true;
        }
    }
    return false;
}
document.getElementById('reset4').addEventListener('click', initConnect4);

/* Init first boards when sections load */
initConnect4();
</script>

</body>
</html>
