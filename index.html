<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Puzzle Challenge</title>
<style>
  body {
    background-color: #121212;
    color: white;
    font-family: Arial, sans-serif;
    text-align: center;
    margin: 0;
    padding: 0;
  }
  h1, h3, p { color: white; }

  .puzzle-section {
    display: none;
    margin-top: 20px;
  }

  /* Code entry */
  .code-input {
    width: 50px;
    height: 50px;
    text-align: center;
    font-size: 28px;
    margin: 5px;
    background-color: #1e1e1e;
    color: white;
    border: 2px solid #333;
    text-transform: uppercase;
  }

  /* Puzzle 1: outer ring / grid */
  .outer-ring {
    display: grid;
    grid-template-columns: repeat(5, 60px);
    grid-gap: 2px;
    margin: 20px auto;
  }
  .outer-cell {
    width: 60px;
    height: 60px;
    background-color: transparent;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 32px;
    cursor: pointer;
    user-select: none;
    border: none;
    color: white;
  }
  .outer-cell.cell {
    background-color: #1e1e1e;
  }
  .outer-cell.visibleO {
    background-color: #1e1e1e;
    color: white;
  }

  /* Puzzle 2: crossword */
  #crossword-container {
    margin-top: 40px; /* extra black space above */
  }
  .crossword {
    border-collapse: collapse;
    margin: auto;
  }
  .crossword td {
    position: relative;
    width: 40px;
    height: 40px;
    border: 1px solid #888;
  }
  .crossword td.black {
    background: #000;
  }
  .cw-cell {
    width: 100%;
    height: 100%;
    border: none;
    text-align: center;
    font-size: 20px;
    color: #000;
    background: #fff;
    text-transform: uppercase;
  }
  .cw-num {
    position: absolute;
    top: 2px;
    left: 2px;
    font-size: 10px;
    color: #000;
  }
  #crossword-clues {
    text-align: left;
    max-width: 600px;
    margin: 20px auto;
    color: white;
  }

  /* Buttons */
  button {
    margin-top: 20px;
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
    background: #333;
    color: white;
    border: none;
  }
</style>
</head>
<body>

<!-- Code entry -->
<div id="code-entry" class="puzzle-section" style="display:block;">
  <h1>Enter Code</h1>
  <div>
    <input type="text" maxlength="1" class="code-input" id="code1">
    <input type="text" maxlength="1" class="code-input" id="code2">
    <input type="text" maxlength="1" class="code-input" id="code3">
    <input type="text" maxlength="1" class="code-input" id="code4">
    <input type="text" maxlength="1" class="code-input" id="code5">
  </div>
</div>

<!-- Puzzle 1 -->
<div id="puzzle1" class="puzzle-section">
  <h1>Puzzle 1</h1>
  <div id="outer-ring" class="outer-ring"></div>
  <div id="result"></div>
  <button id="reset-btn">Reset</button>
  <button id="next1" style="display:none;" onclick="showSection('puzzle2')">Next</button>
</div>

<!-- Puzzle 2 -->
<div id="puzzle2" class="puzzle-section">
  <div id="crossword-container"></div>
  <button id="next2" style="display:none;" onclick="showSection('puzzle3')">Next</button>
  <div id="crossword-clues">
    <h3>ACROSS</h3>
    <p>1A. 2F Lecturers</p>
    <p>5A. With 8A, Monty Hall variant answer</p>
    <p>6A. What e = 2?</p>
    <p>8A. See 5A</p>
    <p>10A. Clothing item same length as forearm</p>
    <h3>DOWN</h3>
    <p>1D. Fastened bands, strips of land, vocal technique</p>
    <p>2D. George and Ruthie's specialty</p>
    <p>3D. The beginning of knowledge...</p>
    <p>4D. What does a sender do?</p>
    <p>7D. Satisfied reaction to solving</p>
    <p>9D. Complex math clue</p>
  </div>
</div>

<!-- Puzzle 3 -->
<div id="puzzle3" class="puzzle-section">
  <h1>Puzzle 3 Coming Soon</h1>
</div>

<script>
function showSection(id) {
  document.querySelectorAll('.puzzle-section').forEach(sec => sec.style.display = 'none');
  document.getElementById(id).style.display = 'block';
  if (id === 'puzzle1') startPuzzle1();
  if (id === 'puzzle2') buildCrossword();
}

/* Code entry */
const codeInputs = document.querySelectorAll('.code-input');
codeInputs.forEach((input, index) => {
  input.addEventListener('input', () => {
    input.value = input.value.toUpperCase();
    if (input.value.length === 1 && index < codeInputs.length - 1) {
      codeInputs[index + 1].focus();
    }
    checkCode();
  });
});
function checkCode() {
  const code = Array.from(codeInputs).map(inp => inp.value.toUpperCase()).join('');
  if (code === 'JONES') showSection('puzzle1');
}

/* Puzzle 1 */
let outerRing = [];
let gameActive = true;
function startPuzzle1() {
  const outerRingContainer = document.getElementById('outer-ring');
  outerRingContainer.innerHTML = '';
  outerRing = Array(25).fill(null);
  gameActive = true;

  for (let i = 0; i < 25; i++) {
    const cell = document.createElement('div');
    cell.classList.add('outer-cell');
    if ((i >= 6 && i <= 8) || (i >= 11 && i <= 13) || (i >= 16 && i <= 18)) {
      cell.classList.add('cell');
      cell.addEventListener('click', () => handlePlayerMove(i));
    }
    outerRingContainer.appendChild(cell);
  }
  cpuMove();
}

function cpuMove() {
  if (!gameActive) return;
  if ([6,7,8,11,12,13,16,17,18].every(i => outerRing[i] === null)) {
    makeMove(12, 'X');
    return;
  }
  const available = [6,7,8,11,12,13,16,17,18].filter(i => outerRing[i] === null);
  if (available.length) makeMove(available[0], 'X');
}

function makeMove(index, player) {
  const cell = document.getElementById('outer-ring').children[index];
  cell.textContent = player;
  if (player === 'O') cell.classList.add('visibleO');
  outerRing[index] = player;
  if (isWin(player)) {
    document.getElementById('result').textContent = player === 'O' ? 'You Win!' : 'You Lose!';
    gameActive = false;
    if (player === 'O') document.getElementById('next1').style.display = 'block';
    return;
  }
  if (isTie()) {
    document.getElementById('result').textContent = 'Tie!';
    gameActive = false;
  }
}

function handlePlayerMove(index) {
  if (!gameActive || outerRing[index] !== null) return;
  makeMove(index, 'O');
  if (gameActive) cpuMove();
}

function isWin(player) {
  const wins = [
    [6,7,8],[11,12,13],[16,17,18],
    [6,11,16],[7,12,17],[8,13,18],
    [6,12,18],[8,12,16]
  ];
  return wins.some(line => line.every(i => outerRing[i] === player));
}

function isTie() {
  return [6,7,8,11,12,13,16,17,18].every(i => outerRing[i] !== null);
}

document.getElementById('reset-btn').addEventListener('click', startPuzzle1);

/* Puzzle 2: crossword */
function buildCrossword() {
  const container = document.getElementById('crossword-container');
  container.innerHTML = '';
  const grid = [
    ['B','E','L','K','S'],
    ['E','*','O','N','E'],
    ['L','O','G','*','N'],
    ['T','H','I','R','D'],
    ['S','O','C','K','S']
  ];
  const numbers = {
    '0,0':1,'0,2':2,'0,3':3,'0,4':4,
    '1,2':5,'2,0':6,'2,1':7,'3,0':8,
    '3,3':9,'4,0':10
  };
  const table = document.createElement('table');
  table.classList.add('crossword');
  for (let r=0;r<5;r++) {
    const tr = document.createElement('tr');
    for (let c=0;c<5;c++) {
      const td = document.createElement('td');
      if (grid[r][c] === '*') {
        td.classList.add('black');
      } else {
        const input = document.createElement('input');
        input.maxLength = 1;
        input.classList.add('cw-cell');
        input.dataset.row = r;
        input.dataset.col = c;
        td.appendChild(input);
      }
      if (numbers[`${r},${c}`]) {
        const num = document.createElement('span');
        num.classList.add('cw-num');
        num.textContent = numbers[`${r},${c}`];
        td.appendChild(num);
      }
      tr.appendChild(td);
    }
    table.appendChild(tr);
  }
  container.appendChild(table);
  container.addEventListener('input', checkCrossword);
}

function checkCrossword() {
  const target = [
    ['B','E','L','K','S'],
    ['E','','O','N','E'],
    ['L','O','G','','N'],
    ['T','H','I','R','D'],
    ['S','O','C','K','S']
  ];
  let correct = true;
  document.querySelectorAll('.cw-cell').forEach(cell => {
    const r = parseInt(cell.dataset.row);
    const c = parseInt(cell.dataset.col);
    if (cell.value.toUpperCase() !== target[r][c]) correct = false;
  });
  if (correct) document.getElementById('next2').style.display = 'block';
}
</script>
</body>
</html>
